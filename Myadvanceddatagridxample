<?xml version="1.0" encoding="utf-8"?>
<s:Module xmlns:fx="http://ns.adobe.com/mxml/2009"
		  xmlns:s="library://ns.adobe.com/flex/spark"
		  xmlns:mx="library://ns.adobe.com/flex/mx"
		  width="100%" height="100%" creationComplete="init()" remove="distroyall(event)" xmlns:components3="examples.components.*">
	
	<fx:Declarations>
	
	</fx:Declarations>	
	<fx:Script>
		<![CDATA[
			import mx.core.FlexGlobals;	
			import mx.events.FlexEvent;
			import mx.controls.Alert;
			import com.wengfx.services.CommonDGService;
			import com.wengfx.services.CommonTransaction;
			import mx.rpc.events.FaultEvent;
			
			public var globalDGService:CommonDGService=FlexGlobals.topLevelApplication.globalDGService;
			public var transObj:CommonTransaction;
			
			//INIT
			public function init():void{
				//Init a transaction obj(save all the datagrids that are registered in )	
				transObj=FlexGlobals.topLevelApplication.globalDGService.getNewTransObj();
				
				//register a datagrid
				transObj.registerObj(dw_1,"dw_justfortest");							
			}

			//RETRIEVE
			protected function cb_cx_clickHandler():void
			{
				transObj.retrieve2(dw_1,true,false,,queryFault,"testargvalue");
			}
			
			//RETRIEVE ERROR
			protected function queryFault(event:FaultEvent):void{
				Alert.show("Retrieve error:"+event.toString(),"error",Alert.OK);
			}			
			
			//ADD
			protected function cb_add_clickHandler(event:MouseEvent):void
			{
				transObj.operate(dw_1,false);		
			}
			
			//EDIT
			protected function cb_edit_clickHandler(event:MouseEvent):void
			{
				transObj.operate(dw_1,true);					
			}
			
			//DELETE
			protected function cb_del_clickHandler(event:MouseEvent):void
			{
				transObj.del(dw_1,true);
			}						
			
			//SAVE
			protected function cb_save_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				transObj.saveAll();		
			}
			
		]]>
	</fx:Script>
		<s:Button id="cb_query" x="10" y="7" label="retrieve" click="cb_cx_clickHandler()"/>
		<s:Button id="cb_add" x="110" y="7" label="addrow" click="cb_add_clickHandler(event)"/>
		<s:Button id="cb_del" x="210" y="7" label="deleterows" click="cb_del_clickHandler(event)"/>
		<s:Button id="cb_edit" x="310" y="7" label="editrow" click="cb_edit_clickHandler(event)"/>
		<s:Button id="cb_save" x="410" y="7" label="save" click="cb_save_clickHandler(event)"/>
	
		<mx:AdvancedDataGrid id="dw_1" x="0" y="36" width="100%" height="496"
							 allowMultipleSelection="true" designViewDataType="flat"
							 doubleClick="cb_edit_clickHandler(event)" doubleClickEnabled="true"
							 editable="false" horizontalScrollPolicy="auto"
							 selectionMode="multipleRows" verticalScrollPolicy="auto"> 
		</mx:AdvancedDataGrid>		
</s:Module>
